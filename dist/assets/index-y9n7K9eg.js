import{r as e,a as s,b as a}from"./vendor-2KnJ_jrg.js";import{u as t,L as r,a as n,b as l,R as i,c,B as o}from"./router-lOrOEvDf.js";import{z as d,W as m,C as x,a as u,L as h,B as p,X as g,A as b,b as j,D as f,U as y,H as N,P as v,T as w,c as C,M as S,d as k,e as D,f as P,g as E,h as $,i as I,E as F,j as A,k as L,l as z,m as _,n as G,o as O,F as U}from"./ui-CSJQhN6N.js";import{B as M}from"./ethers-Be_dV6J1.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&s(e)}).observe(document,{childList:!0,subtree:!0})}function s(e){if(e.ep)return;e.ep=!0;const s=function(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?s.credentials="include":"anonymous"===e.crossOrigin?s.credentials="omit":s.credentials="same-origin",s}(e);fetch(e.href,s)}}();var B={exports:{}},T={},q=e,H=Symbol.for("react.element"),W=Symbol.for("react.fragment"),R=Object.prototype.hasOwnProperty,J=q.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,V={key:!0,ref:!0,__self:!0,__source:!0};function K(e,s,a){var t,r={},n=null,l=null;for(t in void 0!==a&&(n=""+a),void 0!==s.key&&(n=""+s.key),void 0!==s.ref&&(l=s.ref),s)R.call(s,t)&&!V.hasOwnProperty(t)&&(r[t]=s[t]);if(e&&e.defaultProps)for(t in s=e.defaultProps)void 0===r[t]&&(r[t]=s[t]);return{$$typeof:H,type:e,key:n,ref:l,props:r,_owner:J.current}}T.Fragment=W,T.jsx=K,T.jsxs=K,B.exports=T;var Y=B.exports,Q={},X=s;Q.createRoot=X.createRoot,Q.hydrateRoot=X.hydrateRoot;const Z={chainId:8453,name:"Base",rpcUrl:"https://mainnet.base.org",blockExplorer:"https://basescan.org",nativeCurrency:{name:"Ethereum",symbol:"ETH",decimals:18},color:"#0052FF",enabled:!0},ee=[Z,{chainId:84532,name:"Base Sepolia",rpcUrl:"https://sepolia.base.org",blockExplorer:"https://sepolia.basescan.org",nativeCurrency:{name:"Ethereum",symbol:"ETH",decimals:18},color:"#0052FF",enabled:!1}].filter(e=>e.enabled),se="splitpay-groups",ae="MetaMask no est√° instalado. Por favor, instala MetaMask para continuar.",te="Conexi√≥n cancelada por el usuario.",re="Conexi√≥n ya en progreso. Por favor, espera.",ne="Red no soportada. Por favor, cambia a la red Base.",le="Error al conectar wallet:",ie="Agregar red cancelado por el usuario.",ce="Error al agregar la red:",oe="Este participante ya est√° en el grupo.",de="Pago no encontrado.",me="Wallet conectada en",xe="Wallet desconectada.",ue="Cambiado a",he="agregada exitosamente.",pe="Grupo creado exitosamente.",ge="Gasto agregado.",be="Gasto eliminado.",je="Gasto cancelado.",fe="Grupo actualizado.",ye="Grupo eliminado.",Ne="Nombre agregado para",ve="Pago creado.",we="Pago marcado como completado.",Ce=e.createContext(void 0),Se=({children:s})=>{const[a,t]=e.useState(null),[r,n]=e.useState(null),[l,i]=e.useState(null),[c,o]=e.useState(null),[m,x]=e.useState(!1),u=!!a&&!!l,h=ee.find(e=>e.chainId===r)||null,p=r===Z.chainId,g=e.useCallback(e=>e?`${e.slice(0,6)}...${e.slice(-4)}`:"",[]),b=e.useCallback(e=>{const s=ee.find(s=>s.chainId===e);return s?.name||`Chain ${e}`},[]),j=e.useCallback(e=>ee.some(s=>s.chainId===e&&s.enabled),[]),f=e.useCallback((e="default")=>{if("undefined"==typeof window)return null;switch(e){case"metamask":return window.ethereum?.isMetaMask?window.ethereum:null;case"rabby":return window.ethereum?.isRabby?window.ethereum:null;case"coinbase":return window.ethereum?.isCoinbaseWallet?window.ethereum:null;case"trust":return window.ethereum?.isTrust?window.ethereum:null;default:return window.ethereum}},[]),y=e.useCallback(async(e="default")=>{const s=f(e);if(s){x(!0);try{const e=new M(s),a=await e.send("eth_requestAccounts",[]);if(0===a.length)throw new Error("No se encontraron cuentas");const r=await e.getSigner(),l=await e.getNetwork(),c=Number(l.chainId);if(!j(c))return d.error(`${ne} ${b(c)}`),void(await v(Z.chainId));i(e),o(r),t(a[0]),n(c),d.success(`${me} ${b(c)}`),console.log("üîó Wallet conectada:",{address:a[0],network:b(c),chainId:c})}catch(a){if(console.error("Error connecting wallet:",a),"object"==typeof a&&null!==a&&"code"in a){const e=a.code;4001===e?d.error(te):-32002===e?d.error(re):d.error(`${le} ${String(a)}`)}else d.error(`${le} ${String(a)}`)}finally{x(!1)}}else d.error(ae)},[j,b,f]),N=e.useCallback(()=>{t(null),n(null),i(null),o(null),d.success(xe),console.log("üîå Wallet desconectada")},[]),v=e.useCallback(async e=>{if(!window.ethereum)return void d.error(ae);const s=ee.find(s=>s.chainId===e);if(s)try{await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:`0x${e.toString(16)}`}]}),d.success(`${ue} ${s.name}`)}catch(a){"object"==typeof a&&null!==a&&"code"in a&&4902===a.code?await w(e):(console.error("Error switching network:",a),d.error(`Error al cambiar a ${s.name}`))}else d.error(ne)},[]),w=e.useCallback(async e=>{if(!window.ethereum)return;const s=ee.find(s=>s.chainId===e);if(s)try{await window.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:`0x${e.toString(16)}`,chainName:s.name,rpcUrls:[s.rpcUrl],blockExplorerUrls:[s.blockExplorer],nativeCurrency:s.nativeCurrency}]}),d.success(`${s.name} ${he}`)}catch(a){console.error("Error adding network:",a),"object"==typeof a&&null!==a&&"code"in a&&4001===a.code?d.error(ie):d.error(`${ce} ${s.name}`)}else d.error(ne)},[]);e.useEffect(()=>{if(!window.ethereum)return;const e=new M(window.ethereum);(async()=>{try{const s=await e.send("eth_accounts",[]);if(s.length>0){const a=await e.getNetwork(),r=Number(a.chainId);if(j(r)){t(s[0]),n(r),i(e);const a=await e.getSigner();o(a)}}}catch(s){console.error("Error checking connection:",s)}})();const s=e=>{0===e.length?N():(t(e[0]),d("Cuenta cambiada",{icon:"‚ÑπÔ∏è"}))},a=e=>{const s=Number(e);n(s),j(s)?d.success(`${ue} ${b(s)}`):d.error(`${ne} ${b(s)}`),setTimeout(()=>window.location.reload(),1e3)},r=e=>{console.log("üîó Wallet conectada:",e)},l=e=>{console.log("üîå Wallet desconectada:",e),N()};return window.ethereum.on("accountsChanged",s),window.ethereum.on("chainChanged",a),window.ethereum.on("connect",r),window.ethereum.on("disconnect",l),()=>{window.ethereum?.removeListener&&(window.ethereum.removeListener("accountsChanged",s),window.ethereum.removeListener("chainChanged",a),window.ethereum.removeListener("connect",r),window.ethereum.removeListener("disconnect",l))}},[N,j,b,v]);const C=e.useMemo(()=>({account:a,chainId:r,provider:l,signer:c,isConnected:u,isLoading:m,currentNetwork:h,supportedNetworks:ee,isBaseNetwork:p,connectWallet:y,disconnectWallet:N,switchNetwork:v,addNetwork:w,formatAddress:g,getNetworkName:b,isNetworkSupported:j}),[a,r,l,c,u,m,h,p,y,N,v,w,g,b,j]);return Y.jsx(Ce.Provider,{value:C,children:s})},ke=()=>{const s=e.useContext(Ce);if(void 0===s)throw new Error("useWeb3 must be used within a Web3Provider");return s},De=(e,s,a,t,r,n,l)=>({id:`notif_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:e,groupId:s,groupName:a,message:t,amount:n,from:l,to:r,timestamp:(new Date).toISOString(),read:!1}),Pe=(e,s)=>{const a=`notifications_${e.toLowerCase()}`,t=JSON.parse(localStorage.getItem(a)||"[]");t.push(s),localStorage.setItem(a,JSON.stringify(t))},Ee=(e,s)=>{const a={};e.participants.forEach(e=>a[e]=0),e.expenses.filter(e=>"active"===e.status).forEach(s=>{const t=s.amount/e.participants.length;e.participants.forEach(e=>{e.toLowerCase()===s.paidBy.toLowerCase()?a[e]+=s.amount-t:a[e]-=t})}),e.payments.filter(e=>"completed"===e.status).forEach(e=>{a[e.from]+=e.amount,a[e.to]-=e.amount});const t=[],r=[],n=[];for(const d in a)a[d]>0?r.push({address:d,amount:a[d]}):a[d]<0&&n.push({address:d,amount:Math.abs(a[d])});let l=0,i=0;for(;l<r.length&&i<n.length;){const e=r[l],s=n[i],a=Math.min(e.amount,s.amount);a>.01&&t.push({from:s.address,to:e.address,amount:a}),e.amount-=a,s.amount-=a,e.amount<=.01&&l++,s.amount<=.01&&i++}const c=t.filter(e=>e.from.toLowerCase()===s.toLowerCase()).reduce((e,s)=>e+s.amount,0),o=t.filter(e=>e.to.toLowerCase()===s.toLowerCase()).reduce((e,s)=>e+s.amount,0);return{debts:t,userOwes:c,userIsOwed:o}},$e=e.createContext(void 0),Ie=({children:s})=>{const[a,t]=e.useState([]),[r,n]=e.useState(null),[l,i]=e.useState(!1);e.useEffect(()=>{const e=()=>{try{const e=((e,s)=>{try{const a=localStorage.getItem(e);return a?JSON.parse(a):s}catch(a){return console.error("Error loading from localStorage:",a),s}})(se,[]);t(e),console.log("üìÅ Grupos cargados:",e.length)}catch(e){console.error("Error loading groups:",e),d.error(le)}};e();const s=()=>{e()};window.addEventListener("storage",s);const a=setInterval(e,1e3);return()=>{window.removeEventListener("storage",s),clearInterval(a)}},[]);const c=e.useCallback(e=>{try{((e,s)=>{try{localStorage.setItem(e,JSON.stringify(s))}catch(a){console.error("Error saving to localStorage:",a)}})(se,e),t(e)}catch(s){console.error("Error saving groups:",s),d.error(le)}},[]),o=e.useCallback(async e=>{i(!0);try{const s={...e,id:`group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,createdAt:(new Date).toISOString(),startDate:(new Date).toISOString(),currency:"USDC",divisionMethod:"equal",status:"active",expenses:[],payments:[],totalAmount:0,participantNames:{}},t=[...a,s];return c(t),d.success(`${pe} "${s.name}"`),console.log("‚úÖ Grupo creado:",s.name),!0}catch(s){return console.error("Error creating group:",s),d.error("Error al crear el grupo"),!1}finally{i(!1)}},[a,c]),m=e.useCallback(async(e,s)=>{i(!0);try{const t=a.map(a=>{if(a.id===e){const t={...s,id:`expense_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,createdAt:(new Date).toISOString(),status:"active",groupId:e};return a.participants.forEach(e=>{if(e.toLowerCase()!==t.paidBy.toLowerCase()){const s=De("expense_added",a.id,a.name,`Se ha a√±adido un gasto de ${t.amount.toFixed(2)} USDC en "${a.name}"`,e,t.amount,t.paidBy);Pe(e,s)}}),{...a,expenses:[...a.expenses,t],totalAmount:a.totalAmount+(t.amount||0)}}return a});return c(t),d.success(`${ge} "${s.description}"`),console.log("üí∞ Gasto agregado:",s.description),!0}catch(t){return console.error("Error adding expense:",t),d.error(le),!1}finally{i(!1)}},[a,c]),x=e.useCallback(async(e,s)=>{i(!0);try{const t=a.map(a=>{if(a.id===e){const e=a.expenses.find(e=>e.id===s);return e?{...a,expenses:a.expenses.filter(e=>e.id!==s),totalAmount:a.totalAmount-(e.amount||0)}:a}return a});return c(t),d.success(be),console.log("üóëÔ∏è Gasto eliminado:",s),!0}catch(t){return console.error("Error deleting expense:",t),d.error(le),!1}finally{i(!1)}},[a,c]),u=e.useCallback(async(e,s)=>{i(!0);try{const t=a.map(a=>{if(a.id===e){if(!a.expenses.find(e=>e.id===s))return a;const e=a.expenses.map(e=>e.id===s?{...e,status:"cancelled"}:e);return{...a,expenses:e}}return a});return c(t),d.success(je),console.log("‚ùå Gasto cancelado:",s),!0}catch(t){return console.error("Error cancelling expense:",t),d.error(le),!1}finally{i(!1)}},[a,c]),h=e.useCallback(async e=>{try{const s=a.find(s=>s.id===e);return s?(n(s),s):null}catch(s){return console.error("Error getting group:",s),null}},[a]),p=e.useCallback(async(e,s)=>{i(!0);try{const t=a.map(a=>a.id===e?{...a,...s}:a);return c(t),d.success(fe),console.log("üîÑ Grupo actualizado:",e),!0}catch(t){return console.error("Error updating group:",t),d.error(le),!1}finally{i(!1)}},[a,c]),g=e.useCallback(async e=>{i(!0);try{const s=a.filter(s=>s.id!==e);return c(s),d.success(ye),console.log("üóëÔ∏è Grupo eliminado:",e),!0}catch(s){return console.error("Error deleting group:",s),d.error(le),!1}finally{i(!1)}},[a,c]),b=e.useCallback(async(e,s)=>{i(!0);try{const t=a.map(a=>a.id===e?a.participants.includes(s.address)?(d.error(oe),a):{...a,participants:[...a.participants,s.address],participantNames:{...a.participantNames,[s.address.toLowerCase()]:s.name||s.address}}:a);return c(t),d.success("Participante agregado exitosamente"),!0}catch(t){return console.error("Error adding participant:",t),d.error(le),!1}finally{i(!1)}},[a,c]),j=e.useCallback(async(e,s,t)=>{i(!0);try{const r=a.map(a=>a.id===e?{...a,participantNames:{...a.participantNames,[s.toLowerCase()]:t}}:a);return c(r),d.success(`${Ne} "${t}" para ${s.slice(0,6)}...${s.slice(-4)}`),!0}catch(r){return console.error("Error adding participant name:",r),d.error(le),!1}finally{i(!1)}},[a,c]),f=e.useCallback((e,s)=>{const t=a.find(s=>s.id===e);return t&&t.participantNames&&t.participantNames[s.toLowerCase()]||`${s.slice(0,6)}...${s.slice(-4)}`},[a]),y=e.useCallback(async(e,s,t,r)=>{i(!0);try{const n=a.map(a=>{if(a.id===e){const e={id:`payment_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,from:s,to:t,amount:r,status:"pending",createdAt:(new Date).toISOString()};return{...a,payments:[...a.payments,e]}}return a});return c(n),d.success(ve),!0}catch(n){return console.error("Error creating payment:",n),d.error(le),!1}finally{i(!1)}},[a,c]),N=e.useCallback(async(e,s,t,r)=>{i(!0);try{const n=a.map(a=>{if(a.id===e){const e=a.payments.find(e=>e.id===s);if(!e)return d.error(de),a;const n=a.payments.map(e=>e.id===s?{...e,status:"completed",transactionHash:t,completedAt:(new Date).toISOString(),completedBy:r}:e),l=De("payment_completed",a.id,a.name,`¬°Has recibido un pago de ${e.amount.toFixed(2)} USDC de ${f(a.id,e.from)} en "${a.name}"!`,e.to,e.amount,e.from);return Pe(e.to,l),{...a,payments:n}}return a});return c(n),d.success(we),console.log("‚úÖ Pago completado:",s),!0}catch(n){return console.error("Error completing payment:",n),d.error(le),!1}finally{i(!1)}},[a,c,f]),v=e.useCallback((e,s)=>{const t=a.find(s=>s.id===e);return t?t.payments.filter(e=>e.from.toLowerCase()===s.toLowerCase()&&"pending"===e.status):[]},[a]),w=e.useCallback(e=>{const s=a.find(s=>s.id===e);return s?s.payments.sort((e,s)=>new Date(s.createdAt).getTime()-new Date(e.createdAt).getTime()):[]},[a]),C=e.useCallback(e=>a.filter(s=>s.participants.some(s=>s.toLowerCase()===e.toLowerCase())),[a]),S=e.useCallback((e,s)=>{const t=a.find(s=>s.id===e);if(!t)return 0;const{userOwes:r}=Ee(t,s);return r},[a]),k=e.useCallback(e=>{const s=C(e),a=[];return s.forEach(s=>{const{userOwes:t}=Ee(s,e);t>0&&a.push({groupId:s.id,groupName:s.name,amount:t})}),a},[C]),D=e.useMemo(()=>({groups:a,currentGroup:r,isLoading:l,createGroup:o,addExpense:m,deleteExpense:x,cancelExpense:u,completePayment:N,getGroup:h,updateGroup:p,deleteGroup:g,addParticipant:b,addParticipantName:j,getParticipantName:f,createPayment:y,getPendingPayments:v,getPaymentHistory:w,getGroupsByParticipant:C,getTotalOwed:S,getParticipantDebts:k}),[a,r,l,o,m,x,u,N,h,p,g,b,j,f,y,v,w,C,S,k]);return Y.jsx($e.Provider,{value:D,children:s})},Fe=()=>{const s=e.useContext($e);if(void 0===s)throw new Error("useGroups must be used within a GroupProvider");return s},Ae=()=>{const{account:s,isConnected:a,isLoading:t,connectWallet:r,disconnectWallet:n,formatAddress:l,currentNetwork:i}=ke(),[c,o]=e.useState(!1);return t?Y.jsxs("div",{className:"flex items-center space-x-2 px-4 py-2 bg-base-100 rounded-lg",children:[Y.jsx("div",{className:"w-4 h-4 border-2 border-base-500 border-t-transparent rounded-full animate-spin"}),Y.jsx("span",{className:"text-sm text-base-700",children:"Conectando..."})]}):a?Y.jsxs("div",{className:"flex items-center space-x-3",children:[Y.jsxs("div",{className:"flex items-center space-x-2 px-3 py-1 bg-base-100 rounded-lg",children:[Y.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:i?.color||"#0052FF"}}),Y.jsx("span",{className:"text-sm font-medium text-base-700",children:i?.name||"Base"})]}),Y.jsxs("div",{className:"flex items-center space-x-2 px-3 py-2 bg-base-100 rounded-lg",children:[Y.jsx("span",{className:"text-sm font-mono text-base-700",children:l(s||"")}),Y.jsx("button",{onClick:async()=>{if(s)try{await navigator.clipboard.writeText(s),o(!0),setTimeout(()=>o(!1),2e3)}catch(e){console.error("Error copying address:",e)}},className:"p-1 hover:bg-base-200 rounded transition-colors",title:"Copiar direcci√≥n",children:c?Y.jsx(x,{className:"w-4 h-4 text-green-600"}):Y.jsx(u,{className:"w-4 h-4 text-base-600"})})]}),Y.jsx("button",{onClick:n,className:"p-2 hover:bg-base-200 rounded-lg transition-colors",title:"Desconectar",children:Y.jsx(h,{className:"w-4 h-4 text-base-600"})})]}):Y.jsxs("button",{onClick:()=>r(),className:"flex items-center space-x-2 px-4 py-2 bg-base-500 text-white rounded-lg hover:bg-base-600 transition-colors",children:[Y.jsx(m,{className:"w-4 h-4"}),Y.jsx("span",{className:"text-sm font-medium",children:"Conectar Wallet"})]})},Le=()=>{const{account:s,isConnected:a}=ke(),{getParticipantDebts:t,getGroupsByParticipant:r}=Fe(),[n,l]=e.useState([]),[i,c]=e.useState(!1),[o,d]=e.useState(0);e.useEffect(()=>{a&&s?m():(l([]),d(0))},[a,s]);const m=()=>{if(!s)return;const e=r(s),a=[];e.forEach(e=>{const r=t(s).find(s=>s.groupId===e.id);r&&r.amount>0&&a.push({id:`debt_${e.id}`,type:"debt_reminder",groupId:e.id,groupName:e.name,message:`Tienes una deuda pendiente de $${r.amount.toFixed(2)} USDC`,amount:r.amount,timestamp:(new Date).toISOString(),read:!1})});const n=localStorage.getItem(`notifications_${s}`);if(n){const e=JSON.parse(n);a.push(...e)}l(a),d(a.filter(e=>!e.read).length)},x=e=>{const s=new Date(e),a=(new Date).getTime()-s.getTime();return a<6e4?"Hace un momento":a<36e5?`Hace ${Math.floor(a/6e4)} min`:a<864e5?`Hace ${Math.floor(a/36e5)} h`:s.toLocaleDateString()},u=e=>{switch(e){case"payment_created":return Y.jsx(f,{className:"w-4 h-4 text-blue-600"});case"payment_completed":return Y.jsx(j,{className:"w-4 h-4 text-green-600"});case"debt_reminder":return Y.jsx(b,{className:"w-4 h-4 text-red-600"});case"payment_request":return Y.jsx(p,{className:"w-4 h-4 text-orange-600"});default:return Y.jsx(p,{className:"w-4 h-4 text-gray-600"})}};return a?Y.jsx("div",{className:"fixed top-4 right-4 z-50",children:Y.jsxs("div",{className:"relative",children:[Y.jsxs("button",{onClick:()=>c(!i),className:"relative p-3 bg-white rounded-full shadow-lg border border-gray-200 hover:shadow-xl transition-shadow",children:[Y.jsx(p,{className:"w-6 h-6 text-gray-700"}),o>0&&Y.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:o})]}),i&&Y.jsxs("div",{className:"absolute right-0 top-16 w-80 bg-white rounded-xl shadow-xl border border-gray-200 max-h-96 overflow-y-auto",children:[Y.jsx("div",{className:"p-4 border-b border-gray-200",children:Y.jsxs("div",{className:"flex items-center justify-between",children:[Y.jsx("h3",{className:"font-semibold text-gray-900",children:"Notificaciones"}),Y.jsxs("div",{className:"flex items-center space-x-2",children:[o>0&&Y.jsx("button",{onClick:()=>{l([]),d(0),s&&localStorage.removeItem(`notifications_${s}`)},className:"text-xs text-gray-500 hover:text-gray-700",children:"Limpiar todo"}),Y.jsx("button",{onClick:()=>c(!1),className:"text-gray-400 hover:text-gray-600",children:Y.jsx(g,{size:16})})]})]})}),Y.jsx("div",{className:"max-h-64 overflow-y-auto",children:n.map(e=>Y.jsx("div",{className:"p-4 border-b border-gray-100 hover:bg-gray-50 cursor-pointer "+(e.read?"":"bg-blue-50"),onClick:()=>(e=>{if(l(s=>s.map(s=>s.id===e?{...s,read:!0}:s)),d(e=>Math.max(0,e-1)),s){const a=n.map(s=>s.id===e?{...s,read:!0}:s);localStorage.setItem(`notifications_${s}`,JSON.stringify(a))}})(e.id),children:Y.jsxs("div",{className:"flex items-start space-x-3",children:[Y.jsx("div",{className:"flex-shrink-0 mt-1",children:u(e.type)}),Y.jsxs("div",{className:"flex-1 min-w-0",children:[Y.jsxs("div",{className:"flex items-center justify-between",children:[Y.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.groupName}),Y.jsx("span",{className:"text-xs text-gray-500",children:x(e.timestamp)})]}),Y.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.message}),e.amount&&Y.jsxs("p",{className:"text-sm font-semibold text-gray-900 mt-1",children:["$",e.amount.toFixed(2)," USDC"]})]}),!e.read&&Y.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0 mt-2"})]})},e.id))}),0===n.length&&Y.jsxs("div",{className:"p-8 text-center text-gray-500",children:[Y.jsx(p,{className:"w-8 h-8 mx-auto mb-2 text-gray-300"}),Y.jsx("p",{children:"No hay notificaciones"})]})]})]})}):null},ze=({children:e})=>{const s=t(),a=e=>s.pathname===e;return Y.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-base-50 to-base-100",children:[Y.jsx("header",{className:"bg-white shadow-sm border-b border-base-200",children:Y.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:Y.jsxs("div",{className:"flex justify-between items-center h-16",children:[Y.jsx("div",{className:"flex items-center",children:Y.jsxs(r,{to:"/",className:"flex items-center space-x-2",children:[Y.jsx("div",{className:"w-8 h-8 bg-base-500 rounded-lg flex items-center justify-center",children:Y.jsx(y,{className:"w-5 h-5 text-white"})}),Y.jsx("span",{className:"text-xl font-bold text-base-900",children:"SplitPay"})]})}),Y.jsxs("nav",{className:"hidden md:flex space-x-8",children:[Y.jsxs(r,{to:"/",className:"flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium transition-colors "+(a("/")?"bg-base-100 text-base-700":"text-gray-600 hover:text-base-700 hover:bg-base-50"),children:[Y.jsx(N,{className:"w-4 h-4"}),Y.jsx("span",{children:"Dashboard"})]}),Y.jsxs(r,{to:"/create-group",className:"flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium transition-colors "+(a("/create-group")?"bg-base-100 text-base-700":"text-gray-600 hover:text-base-700 hover:bg-base-50"),children:[Y.jsx(v,{className:"w-4 h-4"}),Y.jsx("span",{children:"Crear Grupo"})]})]}),Y.jsx("div",{className:"flex items-center space-x-4",children:Y.jsx(Ae,{})})]})})}),Y.jsx("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e}),Y.jsx(Le,{}),Y.jsx("footer",{className:"bg-gradient-to-r from-base-50 to-base-100 border-t border-base-200 mt-auto",children:Y.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[Y.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0",children:[Y.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[Y.jsx(m,{className:"w-4 h-4"}),Y.jsx("span",{children:"Powered by Base Network"})]}),Y.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[Y.jsx("span",{children:"¬© 2024 SplitPay"}),Y.jsx("span",{children:"‚Ä¢"}),Y.jsx("span",{children:"Gastos Compartidos en Base"})]}),Y.jsxs("div",{className:"flex items-center space-x-2",children:[Y.jsx("span",{className:"text-sm text-gray-400",children:"Creado por"}),Y.jsxs("a",{href:"https://x.com/SeedsPuntoEth",target:"_blank",rel:"noopener noreferrer",className:"group flex items-center space-x-2 px-3 py-1.5 bg-white/50 hover:bg-white/80 border border-gray-200/50 hover:border-blue-300/50 rounded-full transition-all duration-300 hover:shadow-sm backdrop-blur-sm",children:[Y.jsx("div",{className:"w-5 h-5 bg-gray-600 group-hover:bg-blue-500 rounded-full flex items-center justify-center transition-all duration-300",children:Y.jsx(w,{className:"w-3 h-3 text-white"})}),Y.jsx("span",{className:"text-sm font-medium text-gray-600 group-hover:text-blue-600 transition-colors",children:"Noa"}),Y.jsx("span",{className:"text-xs text-gray-400 group-hover:text-blue-500 transition-colors",children:"@SeedsPuntoEth"})]})]})]}),Y.jsx("div",{className:"mt-4 pt-4 border-t border-base-200",children:Y.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center text-xs text-gray-500 space-y-2 md:space-y-0",children:[Y.jsxs("div",{className:"flex items-center space-x-4",children:[Y.jsx("span",{children:"üîí Transacciones seguras en Base"}),Y.jsx("span",{children:"‚Ä¢"}),Y.jsx("span",{children:"üíé USDC como moneda estable"})]}),Y.jsx("div",{className:"flex items-center space-x-2",children:Y.jsx("span",{children:"Hecho con ‚ù§Ô∏è para la comunidad Base"})})]})})]})})]})},_e=({group:e})=>{return Y.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-base-200 hover:shadow-md transition-shadow",children:Y.jsxs("div",{className:"p-6",children:[Y.jsxs("div",{className:"flex items-start justify-between mb-4",children:[Y.jsxs("div",{className:"flex-1",children:[Y.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:e.name}),Y.jsx("p",{className:"text-sm text-gray-600 mb-2",children:e.description}),Y.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[Y.jsxs("div",{className:"flex items-center space-x-1",children:[Y.jsx(y,{className:"w-4 h-4"}),Y.jsxs("span",{children:[e.participants.length," participantes"]})]}),Y.jsxs("div",{className:"flex items-center space-x-1",children:[Y.jsx(C,{className:"w-4 h-4"}),Y.jsx("span",{children:(a=e.createdAt,new Date(a).toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric"}))})]})]})]}),Y.jsxs("div",{className:"flex items-center space-x-2",children:[Y.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${(e=>{switch(e){case"active":return"bg-green-100 text-green-800";case"completed":return"bg-blue-100 text-blue-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(e.status)}`,children:"active"===e.status?"Activo":e.status}),Y.jsx("button",{className:"p-1 hover:bg-base-100 rounded transition-colors",children:Y.jsx(S,{className:"w-4 h-4 text-gray-400"})})]})]}),Y.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[Y.jsxs("div",{className:"bg-base-50 rounded-lg p-3",children:[Y.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[Y.jsx(f,{className:"w-4 h-4 text-base-600"}),Y.jsx("span",{className:"text-sm font-medium text-base-700",children:"Total Gastado"})]}),Y.jsx("p",{className:"text-lg font-semibold text-base-900",children:(s=e.totalAmount,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(s))})]}),Y.jsxs("div",{className:"bg-base-50 rounded-lg p-3",children:[Y.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[Y.jsx(y,{className:"w-4 h-4 text-base-600"}),Y.jsx("span",{className:"text-sm font-medium text-base-700",children:"Gastos"})]}),Y.jsx("p",{className:"text-lg font-semibold text-base-900",children:e.expenses.length})]})]}),Y.jsxs("div",{className:"mb-4",children:[Y.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Participantes:"}),Y.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.participants.slice(0,3).map((e,s)=>Y.jsxs("span",{className:"px-2 py-1 bg-base-100 text-base-700 rounded-md text-xs font-mono",children:[e.slice(0,6),"...",e.slice(-4)]},s)),e.participants.length>3&&Y.jsxs("span",{className:"px-2 py-1 bg-base-100 text-base-700 rounded-md text-xs",children:["+",e.participants.length-3," m√°s"]})]})]}),Y.jsxs("div",{className:"flex items-center justify-between",children:[Y.jsx(r,{to:`/group/${e.id}`,className:"flex items-center space-x-2 px-4 py-2 bg-base-500 text-white rounded-lg hover:bg-base-600 transition-colors text-sm font-medium",children:Y.jsx("span",{children:"Ver Detalles"})}),Y.jsx("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:Y.jsxs("span",{children:["Divisi√≥n: ",e.divisionMethod]})})]})]})});var s,a},Ge=()=>{const{isConnected:e,account:s}=ke(),{groups:a,getGroupsByParticipant:t}=Fe(),n=s?t(s):a,l=n.length,i=n.reduce((e,s)=>e+s.expenses.length,0),c=n.reduce((e,s)=>e+s.totalAmount,0);return e?Y.jsxs("div",{className:"space-y-8",children:[Y.jsxs("div",{className:"flex items-center justify-between",children:[Y.jsxs("div",{children:[Y.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard"}),Y.jsx("p",{className:"text-gray-600 mt-1",children:"Gestiona tus gastos compartidos en Base"})]}),Y.jsxs(r,{to:"/create-group",className:"flex items-center space-x-2 px-4 py-2 bg-base-500 text-white rounded-lg hover:bg-base-600 transition-colors",children:[Y.jsx(v,{className:"w-4 h-4"}),Y.jsx("span",{children:"Crear Grupo"})]})]}),Y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[Y.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-base-200 p-6",children:Y.jsxs("div",{className:"flex items-center space-x-3",children:[Y.jsx("div",{className:"w-12 h-12 bg-base-100 rounded-lg flex items-center justify-center",children:Y.jsx(y,{className:"w-6 h-6 text-base-600"})}),Y.jsxs("div",{children:[Y.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Grupos Activos"}),Y.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l})]})]})}),Y.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-base-200 p-6",children:Y.jsxs("div",{className:"flex items-center space-x-3",children:[Y.jsx("div",{className:"w-12 h-12 bg-base-100 rounded-lg flex items-center justify-center",children:Y.jsx(f,{className:"w-6 h-6 text-base-600"})}),Y.jsxs("div",{children:[Y.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Gastado"}),Y.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(o=c,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(o))})]})]})}),Y.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-base-200 p-6",children:Y.jsxs("div",{className:"flex items-center space-x-3",children:[Y.jsx("div",{className:"w-12 h-12 bg-base-100 rounded-lg flex items-center justify-center",children:Y.jsx(k,{className:"w-6 h-6 text-base-600"})}),Y.jsxs("div",{children:[Y.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Gastos Registrados"}),Y.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i})]})]})})]}),Y.jsxs("div",{children:[Y.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Y.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Mis Grupos"}),Y.jsxs("span",{className:"text-sm text-gray-500",children:[n.length," grupo",1!==n.length?"s":""]})]}),0===n.length?Y.jsxs("div",{className:"text-center py-12 bg-white rounded-lg shadow-sm border border-base-200",children:[Y.jsx("div",{className:"w-16 h-16 bg-base-100 rounded-full flex items-center justify-center mx-auto mb-4",children:Y.jsx(y,{className:"w-8 h-8 text-base-500"})}),Y.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No tienes grupos a√∫n"}),Y.jsx("p",{className:"text-gray-600 mb-6",children:"Crea tu primer grupo para comenzar a dividir gastos con tus amigos."}),Y.jsxs(r,{to:"/create-group",className:"inline-flex items-center space-x-2 px-4 py-2 bg-base-500 text-white rounded-lg hover:bg-base-600 transition-colors",children:[Y.jsx(v,{className:"w-4 h-4"}),Y.jsx("span",{children:"Crear Primer Grupo"})]})]}):Y.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(e=>Y.jsx(_e,{group:e},e.id))})]}),Y.jsxs("div",{className:"bg-base-50 rounded-lg p-6",children:[Y.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Acciones R√°pidas"}),Y.jsx("div",{className:"flex justify-center",children:Y.jsxs(r,{to:"/create-group",className:"flex items-center space-x-3 p-4 bg-white rounded-lg hover:shadow-sm transition-shadow border border-base-200",children:[Y.jsx("div",{className:"w-10 h-10 bg-base-100 rounded-lg flex items-center justify-center",children:Y.jsx(v,{className:"w-5 h-5 text-base-600"})}),Y.jsxs("div",{children:[Y.jsx("p",{className:"font-medium text-gray-900",children:"Crear Nuevo Grupo"}),Y.jsx("p",{className:"text-sm text-gray-600",children:"Inicia un nuevo grupo de gastos"})]})]})})]})]}):Y.jsx("div",{className:"text-center py-12",children:Y.jsxs("div",{className:"max-w-md mx-auto",children:[Y.jsx("div",{className:"w-16 h-16 bg-base-100 rounded-full flex items-center justify-center mx-auto mb-4",children:Y.jsx(y,{className:"w-8 h-8 text-base-500"})}),Y.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Conecta tu Wallet"}),Y.jsx("p",{className:"text-gray-600 mb-6",children:"Conecta tu wallet de Base para comenzar a dividir gastos con tus amigos."}),Y.jsx("div",{className:"bg-base-50 rounded-lg p-4",children:Y.jsxs("p",{className:"text-sm text-base-700",children:["üí° ",Y.jsx("strong",{children:"Tip:"})," Aseg√∫rate de estar conectado a la red Base para usar SplitPay."]})})]})});var o},Oe=({onAddParticipant:s,onClose:a,existingParticipants:t})=>{const[r,n]=e.useState(""),[l,i]=e.useState(""),[c,o]=e.useState(!1);return Y.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:Y.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg w-full max-w-md",children:[Y.jsxs("div",{className:"flex justify-between items-center mb-4",children:[Y.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Agregar Participante"}),Y.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors",children:Y.jsx(g,{size:20})})]}),Y.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!r.trim()||!l.trim())return void d.error("Por favor completa todos los campos");if(!/^0x[a-fA-F0-9]{40}$/.test(r.trim()))return void d.error("Por favor ingresa una direcci√≥n Ethereum v√°lida (0x...)");const a=r.toLowerCase();if(t.some(e=>e.toLowerCase()===a))d.error("Este participante ya est√° en el grupo");else{o(!0);try{s(r.trim(),l.trim()),n(""),i(""),d.success(`Participante "${l}" agregado`)}catch{d.error("Error al agregar participante")}finally{o(!1)}}},className:"space-y-4",children:[Y.jsxs("div",{children:[Y.jsx("label",{htmlFor:"participantName",className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre del participante *"}),Y.jsx("input",{type:"text",id:"participantName",value:l,onChange:e=>i(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-base-500 focus:border-base-500",placeholder:"Ej: Juan P√©rez",maxLength:50,required:!0})]}),Y.jsxs("div",{children:[Y.jsx("label",{htmlFor:"participantAddress",className:"block text-sm font-medium text-gray-700 mb-2",children:"Direcci√≥n de wallet *"}),Y.jsx("input",{type:"text",id:"participantAddress",value:r,onChange:e=>n(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-base-500 focus:border-base-500 font-mono text-sm",placeholder:"0x...",required:!0}),Y.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Direcci√≥n Ethereum completa (0x + 40 caracteres)"})]}),Y.jsxs("div",{className:"flex space-x-3",children:[Y.jsx("button",{type:"button",onClick:a,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"}),Y.jsx("button",{type:"submit",disabled:c||!r.trim()||!l.trim(),className:"flex-1 flex items-center justify-center space-x-2 px-4 py-2 bg-base-600 text-white rounded-lg hover:bg-base-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:c?Y.jsxs(Y.Fragment,{children:[Y.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),Y.jsx("span",{children:"Agregando..."})]}):Y.jsxs(Y.Fragment,{children:[Y.jsx(v,{size:16}),Y.jsx("span",{children:"Agregar"})]})})]})]})]})})},Ue=()=>{const s=n(),{isConnected:a,account:t,formatAddress:r}=ke(),{createGroup:l,isLoading:i}=Fe(),[c,o]=e.useState({name:"",description:"",category:"general",divisionMethod:"equal",startDate:(new Date).toISOString().split("T")[0],endDate:""}),[d,m]=e.useState(()=>t?[{address:t,name:"T√∫"}]:[]),[x,u]=e.useState(!1),h=e=>{const{name:s,value:a}=e.target;o(e=>({...e,[s]:a}))};return a?Y.jsxs("div",{className:"max-w-2xl mx-auto",children:[Y.jsxs("div",{className:"mb-8",children:[Y.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Crear Nuevo Grupo"}),Y.jsx("p",{className:"text-gray-600",children:"Crea un grupo para dividir gastos con tus amigos usando USDC en Base Network."})]}),Y.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),a)if(d.length<2)alert("Debes agregar al menos 2 participantes (incluy√©ndote a ti)");else try{const e={};d.forEach(s=>{e[s.address.toLowerCase()]=s.name});const a=await l({name:c.name,description:c.description,category:c.category,participants:d.map(e=>e.address)});a&&s("/")}catch(t){console.error("Error creating group:",t)}else alert("Por favor, conecta tu wallet primero")},className:"space-y-6",children:[Y.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-base-200 p-6",children:[Y.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informaci√≥n del Grupo"}),Y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Y.jsxs("div",{children:[Y.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del grupo *"}),Y.jsx("input",{type:"text",id:"name",name:"name",value:c.name,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-base-500 focus:border-base-500",placeholder:"Ej: Viaje a Barcelona",required:!0})]}),Y.jsxs("div",{children:[Y.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-1",children:"Categor√≠a"}),Y.jsxs("select",{id:"category",name:"category",value:c.category,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-base-500 focus:border-base-500",children:[Y.jsx("option",{value:"general",children:"General"}),Y.jsx("option",{value:"travel",children:"Viaje"}),Y.jsx("option",{value:"food",children:"Comida"}),Y.jsx("option",{value:"entertainment",children:"Entretenimiento"}),Y.jsx("option",{value:"utilities",children:"Servicios"}),Y.jsx("option",{value:"other",children:"Otro"})]})]})]}),Y.jsxs("div",{className:"mt-4",children:[Y.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripci√≥n"}),Y.jsx("textarea",{id:"description",name:"description",value:c.description,onChange:h,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-base-500 focus:border-base-500",placeholder:"Describe el prop√≥sito del grupo..."})]})]}),Y.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-base-200 p-6",children:[Y.jsxs("div",{className:"flex justify-between items-center mb-4",children:[Y.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Participantes"}),Y.jsxs("button",{type:"button",onClick:()=>u(!0),className:"flex items-center space-x-2 px-4 py-2 bg-base-500 text-white rounded-lg hover:bg-base-600 transition-colors",children:[Y.jsx(v,{size:16}),Y.jsx("span",{children:"Agregar Participante"})]})]}),0===d.length?Y.jsxs("div",{className:"text-center py-8 text-gray-500",children:[Y.jsx(y,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),Y.jsx("p",{children:"No hay participantes agregados"}),Y.jsx("p",{className:"text-sm",children:"Agrega al menos un participante para crear el grupo"})]}):Y.jsx("div",{className:"space-y-3",children:d.map(e=>Y.jsxs("div",{className:"flex items-center justify-between p-3 bg-base-50 rounded-lg",children:[Y.jsxs("div",{className:"flex items-center space-x-3",children:[Y.jsx("div",{className:"w-8 h-8 bg-base-100 rounded-full flex items-center justify-center",children:Y.jsx(D,{size:16,className:"text-base-600"})}),Y.jsxs("div",{children:[Y.jsx("p",{className:"font-medium text-gray-900",children:e.name}),Y.jsx("p",{className:"text-sm text-gray-500 font-mono",children:r(e.address)})]})]}),e.address!==t&&Y.jsx("button",{type:"button",onClick:()=>{return s=e.address,void m(e=>e.filter(e=>e.address!==s));var s},className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:"Eliminar participante",children:Y.jsx(g,{size:16})})]},e.address))}),Y.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:[Y.jsx("p",{children:"‚Ä¢ T√∫ est√°s incluido autom√°ticamente como participante"}),Y.jsx("p",{children:"‚Ä¢ Agrega las direcciones de wallet de tus amigos"}),Y.jsx("p",{children:"‚Ä¢ M√≠nimo 2 participantes para crear el grupo"})]})]}),Y.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-base-200 p-6",children:[Y.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Configuraci√≥n"}),Y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Y.jsxs("div",{children:[Y.jsx("label",{htmlFor:"divisionMethod",className:"block text-sm font-medium text-gray-700 mb-1",children:"M√©todo de divisi√≥n"}),Y.jsxs("select",{id:"divisionMethod",name:"divisionMethod",value:c.divisionMethod,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-base-500 focus:border-base-500",children:[Y.jsx("option",{value:"equal",children:"Divisi√≥n igual"}),Y.jsx("option",{value:"proportional",children:"Proporcional"})]})]}),Y.jsxs("div",{children:[Y.jsx("label",{htmlFor:"startDate",className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha de inicio"}),Y.jsx("input",{type:"date",id:"startDate",name:"startDate",value:c.startDate,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-base-500 focus:border-base-500",required:!0})]})]}),Y.jsxs("div",{className:"mt-4",children:[Y.jsx("label",{htmlFor:"endDate",className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha de fin (opcional)"}),Y.jsx("input",{type:"date",id:"endDate",name:"endDate",value:c.endDate,onChange:h,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-base-500 focus:border-base-500"})]})]}),Y.jsxs("div",{className:"flex justify-end space-x-4",children:[Y.jsx("button",{type:"button",onClick:()=>s("/"),className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"}),Y.jsx("button",{type:"submit",disabled:i||d.length<2||!c.name.trim(),className:"px-6 py-2 bg-base-500 text-white rounded-lg hover:bg-base-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Creando...":"Crear Grupo"})]})]}),x&&Y.jsx(Oe,{onAddParticipant:(e,s)=>{m(a=>[...a,{address:e,name:s}]),u(!1)},onClose:()=>u(!1),existingParticipants:d.map(e=>e.address)})]}):Y.jsx("div",{className:"text-center py-12",children:Y.jsxs("div",{className:"max-w-md mx-auto",children:[Y.jsx("div",{className:"w-16 h-16 bg-base-100 rounded-full flex items-center justify-center mx-auto mb-4",children:Y.jsx(y,{className:"w-8 h-8 text-base-500"})}),Y.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Conecta tu Wallet"}),Y.jsx("p",{className:"text-gray-600",children:"Necesitas conectar tu wallet para crear un grupo."})]})})},Me=({groupId:s,address:a,currentName:t="",onClose:r})=>{const{addParticipantName:n}=Fe(),[l,i]=e.useState(t),[c,o]=e.useState(!1);return Y.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:Y.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg w-full max-w-md",children:[Y.jsxs("div",{className:"flex justify-between items-center mb-4",children:[Y.jsx("h2",{className:"text-xl font-bold text-gray-800",children:t?"Editar Nombre":"Agregar Nombre"}),Y.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-600 transition-colors",children:Y.jsx(g,{size:20})})]}),Y.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!l.trim())return void d.error("Por favor ingresa un nombre");o(!0);const t=await n(s,a,l.trim());o(!1),t&&r()},className:"space-y-4",children:[Y.jsxs("div",{children:[Y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Direcci√≥n del participante:"}),Y.jsx("div",{className:"bg-gray-100 p-3 rounded-lg text-sm font-mono text-gray-600",children:a})]}),Y.jsxs("div",{children:[Y.jsx("label",{htmlFor:"participantName",className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre del participante:"}),Y.jsx("input",{type:"text",id:"participantName",value:l,onChange:e=>i(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-base-500 focus:border-base-500",placeholder:"Ej: Juan P√©rez",maxLength:50,required:!0})]}),Y.jsxs("div",{className:"flex space-x-3",children:[Y.jsx("button",{type:"button",onClick:r,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"}),Y.jsx("button",{type:"submit",disabled:c||!l.trim(),className:"flex-1 flex items-center justify-center space-x-2 px-4 py-2 bg-base-600 text-white rounded-lg hover:bg-base-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:c?Y.jsxs(Y.Fragment,{children:[Y.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),Y.jsx("span",{children:"Guardando..."})]}):Y.jsxs(Y.Fragment,{children:[Y.jsx(v,{size:16}),Y.jsx("span",{children:t?"Actualizar":"Agregar"})]})})]})]})]})})},Be=({paymentId:s,from:a,to:t,amount:r,onComplete:n,onClose:l})=>{const[i,c]=e.useState(""),[o,m]=e.useState(!1);return Y.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:Y.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg w-full max-w-md",children:[Y.jsxs("div",{className:"flex justify-between items-center mb-4",children:[Y.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Completar Pago"}),Y.jsx("button",{onClick:l,className:"text-gray-400 hover:text-gray-600 transition-colors",children:Y.jsx(g,{size:20})})]}),Y.jsxs("div",{className:"mb-6 p-4 bg-base-50 rounded-lg",children:[Y.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Detalles del Pago"}),Y.jsxs("div",{className:"space-y-2 text-sm",children:[Y.jsxs("div",{className:"flex justify-between",children:[Y.jsx("span",{className:"text-gray-600",children:"De:"}),Y.jsxs("span",{className:"font-mono text-gray-900",children:[a.slice(0,6),"...",a.slice(-4)]})]}),Y.jsxs("div",{className:"flex justify-between",children:[Y.jsx("span",{className:"text-gray-600",children:"Para:"}),Y.jsxs("span",{className:"font-mono text-gray-900",children:[t.slice(0,6),"...",t.slice(-4)]})]}),Y.jsxs("div",{className:"flex justify-between",children:[Y.jsx("span",{className:"text-gray-600",children:"Monto:"}),Y.jsxs("span",{className:"font-bold text-base-700",children:[(x=r,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(x))," USDC"]})]})]})]}),Y.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),i.trim())if(/^0x[a-fA-F0-9]{64}$/.test(i.trim())){m(!0);try{await n(s,i.trim()),l()}catch{d.error("Error al completar el pago")}finally{m(!1)}}else d.error("Por favor ingresa un hash de transacci√≥n v√°lido (0x + 64 caracteres)");else d.error("Por favor ingresa el hash de la transacci√≥n")},className:"space-y-4",children:[Y.jsxs("div",{children:[Y.jsx("label",{htmlFor:"transactionHash",className:"block text-sm font-medium text-gray-700 mb-2",children:"Hash de Transacci√≥n *"}),Y.jsxs("div",{className:"relative",children:[Y.jsx("input",{type:"text",id:"transactionHash",value:i,onChange:e=>c(e.target.value),className:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-base-500 focus:border-base-500 font-mono text-sm",placeholder:"0x...",required:!0}),Y.jsx("button",{type:"button",onClick:()=>{return e=i,navigator.clipboard.writeText(e),void d.success("Copiado al portapapeles");var e},className:"absolute right-2 top-2 p-1 text-gray-400 hover:text-gray-600",title:"Copiar",children:Y.jsx(u,{size:16})})]}),Y.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Hash de la transacci√≥n en Base Network (0x + 64 caracteres)"})]}),Y.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:Y.jsxs("div",{className:"flex items-start space-x-2",children:[Y.jsx(j,{className:"w-5 h-5 text-blue-600 mt-0.5"}),Y.jsxs("div",{className:"text-sm text-blue-800",children:[Y.jsx("p",{className:"font-medium",children:"Verificaci√≥n de Pago"}),Y.jsx("p",{className:"mt-1",children:"Una vez completado, el saldo se actualizar√° autom√°ticamente y se notificar√° a todos los participantes."})]})]})}),Y.jsxs("div",{className:"flex space-x-3",children:[Y.jsx("button",{type:"button",onClick:l,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"}),Y.jsx("button",{type:"submit",disabled:o||!i.trim(),className:"flex-1 flex items-center justify-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:o?Y.jsxs(Y.Fragment,{children:[Y.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),Y.jsx("span",{children:"Completando..."})]}):Y.jsxs(Y.Fragment,{children:[Y.jsx(j,{size:16}),Y.jsx("span",{children:"Completar Pago"})]})})]})]}),Y.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:Y.jsxs("p",{className:"text-xs text-gray-500 text-center",children:["üí° Puedes verificar la transacci√≥n en"," ",Y.jsx("a",{href:`https://basescan.org/tx/${i}`,target:"_blank",rel:"noopener noreferrer",className:"text-base-600 hover:text-base-700 underline",children:"BaseScan"})]})})]})});var x},Te=({groupId:s,from:a,to:t,amount:r,onClose:n})=>{const{formatAddress:l}=ke(),{getParticipantName:i}=Fe(),[c,o]=e.useState(""),[m,x]=e.useState(!1),u=i(s,a),h=i(s,t),b=u||l(a),j=h||l(t);return Y.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:Y.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg w-full max-w-md",children:[Y.jsxs("div",{className:"flex justify-between items-center mb-4",children:[Y.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Solicitar Pago"}),Y.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600 transition-colors",children:Y.jsx(g,{size:20})})]}),Y.jsxs("div",{className:"mb-6 p-4 bg-base-50 rounded-lg",children:[Y.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Detalles del Pago"}),Y.jsxs("div",{className:"space-y-2 text-sm",children:[Y.jsxs("div",{className:"flex justify-between",children:[Y.jsx("span",{className:"text-gray-600",children:"De:"}),Y.jsx("span",{className:"font-medium text-gray-900",children:b})]}),Y.jsxs("div",{className:"flex justify-between",children:[Y.jsx("span",{className:"text-gray-600",children:"Para:"}),Y.jsx("span",{className:"font-medium text-gray-900",children:j})]}),Y.jsxs("div",{className:"flex justify-between",children:[Y.jsx("span",{className:"text-gray-600",children:"Monto:"}),Y.jsxs("span",{className:"font-bold text-base-700",children:[(f=r,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(f))," USDC"]})]})]})]}),Y.jsxs("div",{className:"space-y-4",children:[Y.jsxs("div",{children:[Y.jsx("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700 mb-2",children:"Mensaje personalizado *"}),Y.jsx("textarea",{id:"message",value:c,onChange:e=>o(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-base-500 focus:border-base-500",rows:3,placeholder:"Ej: Hola, necesito que me pagues tu parte del gasto de la cena...",required:!0})]}),Y.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:Y.jsxs("div",{className:"flex items-start space-x-2",children:[Y.jsx(p,{className:"w-5 h-5 text-blue-600 mt-0.5"}),Y.jsxs("div",{className:"text-sm text-blue-800",children:[Y.jsx("p",{className:"font-medium",children:"Notificaci√≥n Autom√°tica"}),Y.jsxs("p",{className:"mt-1",children:["Se enviar√° una notificaci√≥n a ",j," para recordarle el pago pendiente."]})]})]})}),Y.jsxs("div",{className:"flex space-x-3",children:[Y.jsx("button",{type:"button",onClick:n,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"}),Y.jsx("button",{onClick:async()=>{if(c.trim()){x(!0);try{const e={id:`payment_request_${Date.now()}`,type:"payment_request",groupId:s,groupName:"Grupo",message:`Solicitud de pago: ${c}`,amount:r,from:a,to:t,timestamp:(new Date).toISOString(),read:!1},l=JSON.parse(localStorage.getItem(`notifications_${t}`)||"[]");l.push(e),localStorage.setItem(`notifications_${t}`,JSON.stringify(l)),d.success("Solicitud de pago enviada"),n()}catch(e){d.error("Error al enviar la solicitud")}finally{x(!1)}}else d.error("Por favor escribe un mensaje")},disabled:m||!c.trim(),className:"flex-1 flex items-center justify-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:m?Y.jsxs(Y.Fragment,{children:[Y.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),Y.jsx("span",{children:"Enviando..."})]}):Y.jsxs(Y.Fragment,{children:[Y.jsx(P,{size:16}),Y.jsx("span",{children:"Enviar Solicitud"})]})})]})]})]})});var f},qe=({groupId:s,from:a,to:t,amount:r,onClose:n})=>{const{formatAddress:l}=ke(),{getParticipantName:i}=Fe(),[c,o]=e.useState(!1),[m,x]=e.useState(""),u=i(s,a),h=i(s,t),p=u||l(a),b=h||l(t);return Y.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:Y.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg w-full max-w-md",children:[Y.jsxs("div",{className:"flex justify-between items-center mb-4",children:[Y.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Cancelar Deuda"}),Y.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600 transition-colors",children:Y.jsx(g,{size:20})})]}),Y.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:[Y.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[Y.jsx(E,{className:"w-5 h-5 text-red-600"}),Y.jsx("h3",{className:"font-semibold text-red-800",children:"Advertencia"})]}),Y.jsxs("p",{className:"text-sm text-red-700",children:["Esta acci√≥n cancelar√° permanentemente la deuda de ",Y.jsxs("strong",{children:[(j=r,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(j))," USDC"]}),"entre ",Y.jsx("strong",{children:p})," y ",Y.jsx("strong",{children:b}),"."]})]}),Y.jsxs("div",{className:"space-y-4",children:[Y.jsxs("div",{children:[Y.jsx("label",{htmlFor:"reason",className:"block text-sm font-medium text-gray-700 mb-2",children:"Motivo de la cancelaci√≥n *"}),Y.jsx("textarea",{id:"reason",value:m,onChange:e=>x(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-red-500 focus:border-red-500",rows:3,placeholder:"Ej: Error en el c√°lculo, gasto duplicado, acuerdo mutuo...",required:!0})]}),Y.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:Y.jsxs("div",{className:"flex items-start space-x-2",children:[Y.jsx(E,{className:"w-5 h-5 text-yellow-600 mt-0.5"}),Y.jsxs("div",{className:"text-sm text-yellow-800",children:[Y.jsx("p",{className:"font-medium",children:"Importante"}),Y.jsx("p",{className:"mt-1",children:"Esta acci√≥n no se puede deshacer. La deuda ser√° marcada como cancelada y se registrar√° en el historial del grupo."})]})]})}),Y.jsxs("div",{className:"flex space-x-3",children:[Y.jsx("button",{type:"button",onClick:n,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"}),Y.jsx("button",{onClick:async()=>{if(m.trim()){o(!0);try{d.success("Funcionalidad de cancelar deuda en desarrollo"),n()}catch(e){console.error("Error cancelling debt:",e),d.error("Error al cancelar la deuda")}finally{o(!1)}}else d.error("Por favor explica el motivo de la cancelaci√≥n")},disabled:c||!m.trim(),className:"flex-1 flex items-center justify-center space-x-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:c?Y.jsxs(Y.Fragment,{children:[Y.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),Y.jsx("span",{children:"Cancelando..."})]}):Y.jsxs(Y.Fragment,{children:[Y.jsx($,{size:16}),Y.jsx("span",{children:"Cancelar Deuda"})]})})]})]})]})});var j},He=({groupId:s,onPaymentCompleted:a})=>{const{account:t,formatAddress:r}=ke(),{getPendingPayments:n,completePayment:l,getParticipantName:i}=Fe(),[c,o]=e.useState(!1),[d,m]=e.useState(!1),[x,u]=e.useState(!1),[h,g]=e.useState(null),y=t?n(s,t):[];return 0===y.length?null:Y.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-6 mb-6",children:[Y.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[Y.jsx(b,{className:"w-5 h-5 text-yellow-600"}),Y.jsx("h3",{className:"text-lg font-semibold text-yellow-800",children:"Pagos Pendientes"})]}),Y.jsx("div",{className:"space-y-3",children:y.map(e=>{const a=i(s,e.to)||r(e.to);return Y.jsxs("div",{className:"bg-white rounded-lg p-4 border border-yellow-200",children:[Y.jsxs("div",{className:"flex items-center justify-between",children:[Y.jsxs("div",{className:"flex-1",children:[Y.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[Y.jsx(I,{className:"w-4 h-4 text-yellow-600"}),Y.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Pago Pendiente"})]}),Y.jsxs("div",{className:"space-y-1",children:[Y.jsxs("div",{className:"flex items-center space-x-2",children:[Y.jsx(D,{className:"w-4 h-4 text-gray-500"}),Y.jsxs("span",{className:"text-sm text-gray-600",children:["Debe a: ",Y.jsx("span",{className:"font-medium",children:a})]})]}),Y.jsxs("div",{className:"flex items-center space-x-2",children:[Y.jsx(f,{className:"w-4 h-4 text-gray-500"}),Y.jsxs("span",{className:"text-sm text-gray-600",children:["Monto: ",Y.jsxs("span",{className:"font-bold text-yellow-700",children:[(t=e.amount,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(t))," USDC"]})]})]})]})]}),Y.jsxs("div",{className:"flex items-center space-x-2",children:[Y.jsxs("button",{onClick:()=>(e=>{g(e),m(!0)})(e),className:"flex items-center space-x-1 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm",children:[Y.jsx(p,{size:14}),Y.jsx("span",{children:"Avisar"})]}),Y.jsxs("button",{onClick:()=>(e=>{g(e),o(!0)})(e),className:"flex items-center space-x-1 px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm",children:[Y.jsx(j,{size:14}),Y.jsx("span",{children:"Pagar"})]}),Y.jsxs("button",{onClick:()=>(e=>{g(e),u(!0)})(e),className:"flex items-center space-x-1 px-3 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm",children:[Y.jsx($,{size:14}),Y.jsx("span",{children:"Cancelar"})]})]})]}),Y.jsx("div",{className:"mt-3 pt-3 border-t border-yellow-200",children:Y.jsx("p",{className:"text-xs text-yellow-700",children:'üí° Usa "Avisar" para recordar, "Pagar" para completar, o "Cancelar" para anular la deuda'})})]},e.id);var t})}),c&&h&&Y.jsx(Be,{paymentId:h.id,from:h.from,to:h.to,amount:h.amount,onComplete:async(e,r)=>{if(t){await l(s,e,r,t)&&(o(!1),g(null),a&&a())}},onClose:()=>{o(!1),g(null)}}),d&&h&&Y.jsx(Te,{groupId:s,from:h.from,to:h.to,amount:h.amount,onClose:()=>{m(!1),g(null)}}),x&&h&&Y.jsx(qe,{groupId:s,from:h.from,to:h.to,amount:h.amount,onClose:()=>{u(!1),g(null)}})]})},We=({groupId:e})=>{const{getPaymentHistory:s,getParticipantName:a}=Fe(),t=s(e),r=e=>new Date(e).toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),n=e=>{switch(e){case"completed":return Y.jsx(j,{className:"w-4 h-4 text-green-600"});case"pending":return Y.jsx(I,{className:"w-4 h-4 text-yellow-600"});case"disputed":return Y.jsx($,{className:"w-4 h-4 text-red-600"});default:return Y.jsx(I,{className:"w-4 h-4 text-gray-600"})}},l=e=>{switch(e){case"completed":return"bg-green-50 border-green-200";case"pending":return"bg-yellow-50 border-yellow-200";case"disputed":return"bg-red-50 border-red-200";default:return"bg-gray-50 border-gray-200"}},i=e=>{switch(e){case"completed":return"Completado";case"pending":return"Pendiente";case"disputed":return"Disputado";default:return"Desconocido"}};return 0===t.length?Y.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-base-200 p-6",children:[Y.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Historial de Pagos"}),Y.jsxs("div",{className:"text-center py-8 text-gray-500",children:[Y.jsx(f,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),Y.jsx("p",{children:"No hay pagos registrados"}),Y.jsx("p",{className:"text-sm",children:"Los pagos aparecer√°n aqu√≠ cuando se agreguen gastos"})]})]}):Y.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-base-200 p-6",children:[Y.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Historial de Pagos"}),Y.jsx("div",{className:"space-y-3",children:t.map(s=>{const t=a(e,s.from),c=a(e,s.to),o=t||s.from.slice(0,6)+"..."+s.from.slice(-4),d=c||s.to.slice(0,6)+"..."+s.to.slice(-4);return Y.jsxs("div",{className:`p-4 rounded-lg border ${l(s.status)}`,children:[Y.jsxs("div",{className:"flex items-center justify-between mb-2",children:[Y.jsxs("div",{className:"flex items-center space-x-2",children:[n(s.status),Y.jsx("span",{className:"text-sm font-medium text-gray-900",children:i(s.status)})]}),Y.jsx("span",{className:"text-sm text-gray-500",children:r(s.createdAt)})]}),Y.jsxs("div",{className:"space-y-1",children:[Y.jsxs("div",{className:"flex items-center justify-between",children:[Y.jsx("span",{className:"text-sm text-gray-600",children:"De:"}),Y.jsx("span",{className:"text-sm font-medium text-gray-900",children:o})]}),Y.jsxs("div",{className:"flex items-center justify-between",children:[Y.jsx("span",{className:"text-sm text-gray-600",children:"Para:"}),Y.jsx("span",{className:"text-sm font-medium text-gray-900",children:d})]}),Y.jsxs("div",{className:"flex items-center justify-between",children:[Y.jsx("span",{className:"text-sm text-gray-600",children:"Monto:"}),Y.jsx("span",{className:"text-sm font-bold text-gray-900",children:(m=s.amount,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(m))})]}),"completed"===s.status&&s.transactionHash&&Y.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-200",children:[Y.jsxs("div",{className:"flex items-center justify-between",children:[Y.jsx("span",{className:"text-xs text-gray-500",children:"Transacci√≥n:"}),Y.jsxs("a",{href:`https://basescan.org/tx/${s.transactionHash}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center space-x-1 text-xs text-base-600 hover:text-base-700",children:[Y.jsxs("span",{className:"font-mono",children:[s.transactionHash.slice(0,10),"..."]}),Y.jsx(F,{size:12})]})]}),s.completedAt&&Y.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Completado: ",r(s.completedAt)]})]})]})]},s.id);var m})})]})},Re=({children:e,className:s="",padding:a="md",shadow:t="sm",border:r=!0,hover:n=!1,onClick:l})=>{const i=`rounded-lg bg-white ${{none:"",sm:"p-3",md:"p-6",lg:"p-8"}[a]} ${{none:"",sm:"shadow-sm",md:"shadow-md",lg:"shadow-lg"}[t]} ${r?"border border-gray-200":""} ${n?"hover:shadow-md transition-shadow cursor-pointer":""} ${s}`;return Y.jsx("div",{className:i,onClick:l,children:e})},Je=({children:e,variant:s="primary",size:a="md",loading:t=!1,leftIcon:r,rightIcon:n,fullWidth:l=!1,disabled:i,className:c="",...o})=>{const d=`inline-flex items-center justify-center font-medium rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed ${{primary:"bg-base-500 text-white hover:bg-base-600 focus:ring-base-500",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200 focus:ring-gray-500",danger:"bg-red-500 text-white hover:bg-red-600 focus:ring-red-500",ghost:"bg-transparent text-gray-700 hover:bg-gray-100 focus:ring-gray-500"}[s]} ${{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"}[a]} ${l?"w-full":""} ${c}`,m=i||t;return Y.jsxs("button",{className:d,disabled:m,...o,children:[t&&Y.jsx(A,{className:"w-4 h-4 mr-2 animate-spin"}),!t&&r&&Y.jsx("span",{className:"mr-2",children:r}),e,!t&&n&&Y.jsx("span",{className:"ml-2",children:n})]})},Ve=e.forwardRef(({label:e,error:s,success:a,leftIcon:t,rightIcon:r,containerClassName:n="",className:l="",...i},c)=>{const o=`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${s?"border-red-500":""} ${a?"border-green-500":""} ${s||a?"":"border-gray-300"} ${i.disabled?"bg-gray-100 cursor-not-allowed":""} ${l}`;return Y.jsxs("div",{className:`space-y-1 ${n}`,children:[e&&Y.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[e,i.required&&Y.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),Y.jsxs("div",{className:"relative",children:[t&&Y.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:Y.jsx("div",{className:"text-gray-400",children:t})}),Y.jsx("input",{ref:c,className:`${o} ${t?"pl-10":""} ${r||s||a?"pr-10":""}`,...i}),(r||s||a)&&Y.jsxs("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:[s&&Y.jsx(b,{className:"w-4 h-4 text-red-500"}),a&&Y.jsx(j,{className:"w-4 h-4 text-green-500"}),!s&&!a&&r&&Y.jsx("div",{className:"text-gray-400",children:r})]})]}),s&&Y.jsxs("div",{className:"flex items-center space-x-1 text-red-600 text-sm",children:[Y.jsx(b,{className:"w-4 h-4"}),Y.jsx("span",{children:s})]})]})});Ve.displayName="OptimizedInput";const Ke=({groupId:s,debtAmount:a,fromAddress:t,toAddress:r,onPaymentCompleted:n})=>{const{account:l}=ke(),{getParticipantName:i}=Fe(),[c,o]=e.useState(!1),[m,x]=e.useState(""),[u,h]=e.useState(!1),[p,f]=e.useState(null);if(!l||l.toLowerCase()!==t.toLowerCase())return null;const y=i(s,t),N=i(s,r);return Y.jsxs(Y.Fragment,{children:[Y.jsxs(Je,{variant:"primary",size:"sm",leftIcon:Y.jsx(L,{className:"w-4 h-4"}),onClick:()=>o(!0),className:"w-full",children:["Pagar ",a.toFixed(2)," USDC"]}),c&&Y.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:Y.jsxs(Re,{className:"w-full max-w-md",padding:"lg",children:[Y.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Y.jsxs("div",{className:"flex items-center space-x-3",children:[Y.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:Y.jsx(L,{className:"w-5 h-5 text-green-600"})}),Y.jsxs("div",{children:[Y.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Completar Pago"}),Y.jsx("p",{className:"text-sm text-gray-600",children:"Ingresa el hash de la transacci√≥n"})]})]}),Y.jsx("button",{onClick:()=>{o(!1),x(""),f(null)},className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:Y.jsx(g,{className:"w-5 h-5 text-gray-400"})})]}),Y.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:Y.jsxs("div",{className:"space-y-2",children:[Y.jsxs("div",{className:"flex justify-between text-sm",children:[Y.jsx("span",{className:"text-gray-600",children:"De:"}),Y.jsx("span",{className:"font-medium",children:y})]}),Y.jsxs("div",{className:"flex justify-between text-sm",children:[Y.jsx("span",{className:"text-gray-600",children:"Para:"}),Y.jsx("span",{className:"font-medium",children:N})]}),Y.jsxs("div",{className:"flex justify-between text-sm",children:[Y.jsx("span",{className:"text-gray-600",children:"Monto:"}),Y.jsxs("span",{className:"font-semibold text-green-600",children:[a.toFixed(2)," USDC"]})]})]})}),Y.jsxs("div",{className:"space-y-4",children:[Y.jsx(Ve,{label:"Hash de Transacci√≥n",placeholder:"0x...",value:m,onChange:e=>{x(e.target.value),f(null)},error:p||void 0,leftIcon:Y.jsx(b,{className:"w-4 h-4"}),required:!0}),Y.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:Y.jsxs("div",{className:"flex items-start space-x-2",children:[Y.jsx(j,{className:"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0"}),Y.jsxs("div",{className:"text-sm text-blue-800",children:[Y.jsx("p",{className:"font-medium",children:"Instrucciones:"}),Y.jsxs("ol",{className:"mt-1 space-y-1 text-xs",children:[Y.jsx("li",{children:"1. Realiza la transacci√≥n en tu wallet"}),Y.jsx("li",{children:"2. Copia el hash de la transacci√≥n"}),Y.jsx("li",{children:"3. P√©galo en el campo de arriba"}),Y.jsx("li",{children:'4. Haz clic en "Completar Pago"'})]})]})]})}),Y.jsxs("div",{className:"flex space-x-3 pt-4",children:[Y.jsx(Je,{variant:"secondary",size:"md",fullWidth:!0,onClick:()=>{o(!1),x(""),f(null)},disabled:u,children:"Cancelar"}),Y.jsx(Je,{variant:"primary",size:"md",fullWidth:!0,loading:u,onClick:async()=>{if(m.trim())if(/^0x[a-fA-F0-9]{64}$/.test(m.trim())){h(!0),f(null);try{const e=`payment_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,i=JSON.parse(localStorage.getItem("splitpay-groups")||"[]").map(n=>{if(n.id===s){const s={id:e,from:t,to:r,amount:a,status:"completed",transactionHash:m.trim(),createdAt:(new Date).toISOString(),completedAt:(new Date).toISOString(),completedBy:l,notes:"Pago completado mediante hash de transacci√≥n"},i={id:`notif_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:"payment_completed",groupId:n.id,groupName:n.name,message:`¬°Has recibido un pago de ${a.toFixed(2)} USDC de ${n.participantNames?.[t.toLowerCase()]||`${t.slice(0,6)}...${t.slice(-4)}`} en "${n.name}"!`,amount:a,from:t,to:r,timestamp:(new Date).toISOString(),read:!1},c=`notifications_${r.toLowerCase()}`,o=JSON.parse(localStorage.getItem(c)||"[]");return localStorage.setItem(c,JSON.stringify([...o,i])),{...n,payments:[...n.payments,s]}}return n});localStorage.setItem("splitpay-groups",JSON.stringify(i)),d.success(`¬°Pago de ${a.toFixed(2)} USDC completado!`),o(!1),x(""),f(null),n&&n()}catch(e){console.error("Error procesando pago:",e),f(e instanceof Error?e.message:"Error al procesar el pago"),d.error("Error al procesar el pago")}finally{h(!1)}}else f("Por favor ingresa un hash de transacci√≥n v√°lido (0x...)");else f("Por favor ingresa el hash de la transacci√≥n")},disabled:!m.trim()||u,children:u?"Procesando...":"Completar Pago"})]})]})]})})]})},Ye=({groupId:s,onPaymentCompleted:a})=>{const{account:t}=ke(),{groups:r}=Fe(),[n,l]=e.useState(null),[i,c]=e.useState([]),[o,d]=e.useState(0),[m,x]=e.useState(0),u=e.useCallback(async()=>{if(t&&s)try{const e=JSON.parse(localStorage.getItem("splitpay-groups")||"[]").find(e=>e.id===s);if(!e)return;l(e);const{debts:a,userOwes:r,userIsOwed:n}=Ee(e,t);c(a),d(r),x(n)}catch(e){console.error("Error loading group or calculating debts:",e)}},[t,s]);return e.useEffect(()=>{u()},[u]),e.useEffect(()=>{const e=r.find(e=>e.id===s);if(e&&t){l(e);const{debts:s,userOwes:a,userIsOwed:r}=Ee(e,t);c(s),d(a),x(r)}},[r,s,t]),e.useEffect(()=>{const e=()=>{u()};window.addEventListener("storage",e);const s=setInterval(e,1e3);return()=>{window.removeEventListener("storage",e),clearInterval(s)}},[u]),t?n?Y.jsxs("div",{className:"space-y-6",children:[Y.jsxs(Re,{children:[Y.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[Y.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:Y.jsx(L,{className:"w-5 h-5 text-blue-600"})}),Y.jsxs("div",{children:[Y.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Mis Deudas"}),Y.jsx("p",{className:"text-sm text-gray-600",children:"Resumen de pagos pendientes"})]})]}),Y.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Y.jsxs("div",{className:"bg-red-50 rounded-lg p-4",children:[Y.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[Y.jsx(b,{className:"w-4 h-4 text-red-600"}),Y.jsx("span",{className:"text-sm font-medium text-red-800",children:"Debes"})]}),Y.jsxs("p",{className:"text-2xl font-bold text-red-600",children:[o.toFixed(2)," USDC"]})]}),Y.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[Y.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[Y.jsx(L,{className:"w-4 h-4 text-green-600"}),Y.jsx("span",{className:"text-sm font-medium text-green-800",children:"Te deben"})]}),Y.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[m.toFixed(2)," USDC"]})]})]})]}),i.length>0?Y.jsxs(Re,{children:[Y.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[Y.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center",children:Y.jsx(y,{className:"w-5 h-5 text-orange-600"})}),Y.jsxs("div",{children:[Y.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Deudas Pendientes"}),Y.jsx("p",{className:"text-sm text-gray-600",children:"Pagos espec√≠ficos por realizar"})]})]}),Y.jsx("div",{className:"space-y-4",children:i.map((e,t)=>Y.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[Y.jsxs("div",{className:"flex items-center justify-between mb-3",children:[Y.jsxs("div",{className:"flex items-center space-x-3",children:[Y.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:Y.jsx(b,{className:"w-4 h-4 text-red-600"})}),Y.jsxs("div",{children:[Y.jsx("p",{className:"font-medium text-gray-900",children:n.participantNames?.[e.from.toLowerCase()]||`${e.from.slice(0,6)}...${e.from.slice(-4)}`}),Y.jsxs("p",{className:"text-sm text-gray-600",children:["debe a ",n.participantNames?.[e.to.toLowerCase()]||`${e.to.slice(0,6)}...${e.to.slice(-4)}`]})]})]}),Y.jsx("div",{className:"text-right",children:Y.jsxs("p",{className:"text-lg font-semibold text-red-600",children:[e.amount.toFixed(2)," USDC"]})})]}),Y.jsx(Ke,{groupId:s,debtAmount:e.amount,fromAddress:e.from,toAddress:e.to,onPaymentCompleted:()=>{u(),a&&a()}})]},t))})]}):Y.jsxs(Re,{className:"text-center py-8",children:[Y.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:Y.jsx(L,{className:"w-8 h-8 text-green-600"})}),Y.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"¬°Todo al d√≠a!"}),Y.jsx("p",{className:"text-gray-600",children:m>0?`Te deben ${m.toFixed(2)} USDC`:"No tienes deudas pendientes en este grupo"})]}),Y.jsx(Re,{className:"bg-blue-50 border-blue-200",children:Y.jsxs("div",{className:"flex items-start space-x-3",children:[Y.jsx(b,{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0"}),Y.jsxs("div",{className:"text-sm text-blue-800",children:[Y.jsx("p",{className:"font-medium mb-1",children:"¬øC√≥mo funciona el pago?"}),Y.jsxs("ol",{className:"space-y-1 text-xs",children:[Y.jsx("li",{children:'1. Haz clic en "Pagar" para la deuda que quieres saldar'}),Y.jsx("li",{children:"2. Realiza la transacci√≥n en tu wallet"}),Y.jsx("li",{children:"3. Copia el hash de la transacci√≥n"}),Y.jsx("li",{children:"4. P√©galo en el formulario y confirma"}),Y.jsx("li",{children:"5. ¬°La deuda se marcar√° como pagada autom√°ticamente!"})]})]})]})})]}):Y.jsxs(Re,{className:"text-center py-8",children:[Y.jsx("div",{className:"w-8 h-8 border-2 border-gray-300 border-t-blue-600 rounded-full animate-spin mx-auto mb-4"}),Y.jsx("p",{className:"text-gray-600",children:"Cargando informaci√≥n del grupo..."})]}):Y.jsxs(Re,{className:"text-center py-8",children:[Y.jsx(b,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),Y.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Conecta tu Wallet"}),Y.jsx("p",{className:"text-gray-600",children:"Necesitas conectar tu wallet para ver las deudas"})]})},Qe=()=>{const{id:s}=l(),a=n(),{isConnected:t,account:r,formatAddress:i}=ke(),{getGroup:c,addExpense:o,deleteExpense:d,cancelExpense:m,getParticipantName:x,deleteGroup:u,isLoading:h,getTotalOwed:p}=Fe(),[g,b]=e.useState(null),[j,N]=e.useState(!1),[w,C]=e.useState(!1),[S,k]=e.useState(!1),[P,I]=e.useState(""),[F,A]=e.useState(null),[L,U]=e.useState({description:"",amount:"",paidBy:r||""});e.useEffect(()=>{s&&M()},[s]);const M=async()=>{if(s){const e=await c(s);b(e)}},B=()=>{M()},T=(e,s,a)=>{A({from:e,to:s,amount:a}),k(!0)},q=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(e),H=e=>new Date(e).toLocaleDateString("es-ES",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});return t?g?Y.jsxs("div",{className:"max-w-4xl mx-auto",children:[Y.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Y.jsxs("div",{className:"flex items-center space-x-4",children:[Y.jsx("button",{onClick:()=>a("/"),className:"p-2 hover:bg-base-100 rounded-lg transition-colors",children:Y.jsx(z,{className:"w-5 h-5 text-gray-600"})}),Y.jsxs("div",{children:[Y.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:g.name}),Y.jsx("p",{className:"text-gray-600",children:g.description})]})]}),Y.jsxs("div",{className:"flex items-center space-x-3",children:[Y.jsxs("button",{onClick:()=>N(!0),className:"flex items-center space-x-2 px-4 py-2 bg-base-500 text-white rounded-lg hover:bg-base-600 transition-colors",children:[Y.jsx(v,{className:"w-4 h-4"}),Y.jsx("span",{children:"Agregar Gasto"})]}),Y.jsxs("button",{onClick:async()=>{if(!s)return;if(window.confirm(`¬øEst√°s seguro de que quieres eliminar el grupo "${g?.name}"? Esta acci√≥n no se puede deshacer.`)){await u(s)&&a("/")}},className:"flex items-center space-x-2 px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:[Y.jsx(_,{className:"w-4 h-4"}),Y.jsx("span",{children:"Eliminar Grupo"})]})]})]}),r&&Y.jsx(Ye,{groupId:g.id,onPaymentCompleted:B}),r&&Y.jsx("div",{"data-pending-payments":!0,children:Y.jsx(He,{groupId:g.id,onPaymentCompleted:B})}),Y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[Y.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-base-200 p-6",children:Y.jsxs("div",{className:"flex items-center space-x-3",children:[Y.jsx("div",{className:"w-12 h-12 bg-base-100 rounded-lg flex items-center justify-center",children:Y.jsx(f,{className:"w-6 h-6 text-base-600"})}),Y.jsxs("div",{children:[Y.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Gastado"}),Y.jsx("p",{className:"text-2xl font-bold text-gray-900",children:q(g.totalAmount)})]})]})}),Y.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-base-200 p-6",children:Y.jsxs("div",{className:"flex items-center space-x-3",children:[Y.jsx("div",{className:"w-12 h-12 bg-base-100 rounded-lg flex items-center justify-center",children:Y.jsx(G,{className:"w-6 h-6 text-base-600"})}),Y.jsxs("div",{children:[Y.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Gastos"}),Y.jsx("p",{className:"text-2xl font-bold text-gray-900",children:g.expenses.length})]})]})}),Y.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-base-200 p-6",children:Y.jsxs("div",{className:"flex items-center space-x-3",children:[Y.jsx("div",{className:"w-12 h-12 bg-base-100 rounded-lg flex items-center justify-center",children:Y.jsx(y,{className:"w-6 h-6 text-base-600"})}),Y.jsxs("div",{children:[Y.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Participantes"}),Y.jsx("p",{className:"text-2xl font-bold text-gray-900",children:g.participants.length})]})]})})]}),Y.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-base-200 p-6 mb-8",children:[Y.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Participantes y Saldos"}),Y.jsx("div",{className:"space-y-3",children:g.participants.map((e,s)=>{const a=p(g.id,e),t=x(g.id,e)||(e===r?"T√∫":"Participante");return Y.jsxs("div",{className:"flex items-center justify-between p-3 bg-base-50 rounded-lg",children:[Y.jsxs("div",{className:"flex items-center space-x-3",children:[Y.jsx("div",{className:"w-8 h-8 bg-base-100 rounded-full flex items-center justify-center",children:Y.jsx(D,{size:16,className:"text-base-600"})}),Y.jsxs("div",{className:"flex-1",children:[Y.jsxs("div",{className:"flex items-center space-x-2",children:[Y.jsx("p",{className:"font-medium text-gray-900",children:t}),Y.jsx("button",{onClick:()=>(e=>{I(e),C(!0)})(e),className:"p-1 hover:bg-base-200 rounded transition-colors",title:"Editar nombre",children:Y.jsx(O,{size:14,className:"text-base-500"})})]}),Y.jsx("p",{className:"text-sm text-gray-500",children:i(e)})]})]}),Y.jsxs("div",{className:"flex items-center space-x-4",children:[Y.jsx("div",{className:"text-right",children:Y.jsx("p",{className:"font-semibold "+(a>0?"text-red-600":a<0?"text-green-600":"text-gray-600"),children:a>0?`Debe ${q(a)}`:a<0?`Le deben ${q(Math.abs(a))}`:"En balance"})}),r&&a>0&&e.toLowerCase()!==r.toLowerCase()&&Y.jsxs("button",{onClick:()=>T(r,e,a),className:"flex items-center space-x-1 px-3 py-1 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm",title:"Cancelar deuda con este participante",children:[Y.jsx($,{size:14}),Y.jsx("span",{children:"Cancelar Deuda"})]}),r&&a<0&&e.toLowerCase()!==r.toLowerCase()&&Y.jsxs("button",{onClick:()=>T(e,r,Math.abs(a)),className:"flex items-center space-x-1 px-3 py-1 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors text-sm",title:"Cancelar deuda de este participante",children:[Y.jsx(E,{size:14}),Y.jsx("span",{children:"Cancelar Su Deuda"})]})]})]},s)})})]}),Y.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-base-200 p-6",children:[Y.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Gastos"}),0===g.expenses.length?Y.jsxs("div",{className:"text-center py-8",children:[Y.jsx("div",{className:"w-16 h-16 bg-base-100 rounded-full flex items-center justify-center mx-auto mb-4",children:Y.jsx(G,{className:"w-8 h-8 text-base-500"})}),Y.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No hay gastos a√∫n"}),Y.jsx("p",{className:"text-gray-600 mb-4",children:"Agrega el primer gasto para comenzar a dividir los costos."}),Y.jsx("button",{onClick:()=>N(!0),className:"px-4 py-2 bg-base-500 text-white rounded-lg hover:bg-base-600 transition-colors",children:"Agregar Primer Gasto"})]}):Y.jsx("div",{className:"space-y-4",children:g.expenses.map((e,a)=>Y.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg "+("cancelled"===e.status?"bg-gray-100 border border-gray-200":"bg-base-50"),children:[Y.jsxs("div",{className:"flex-1",children:[Y.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[Y.jsx("h4",{className:"font-medium text-gray-900",children:e.description}),"cancelled"===e.status&&Y.jsx("span",{className:"px-2 py-1 bg-gray-200 text-gray-600 text-xs rounded-full",children:"Cancelado"})]}),Y.jsxs("p",{className:"text-sm text-gray-500",children:["Pagado por: ",e.paidBy?.slice(0,6),"...",e.paidBy?.slice(-4)]}),Y.jsx("p",{className:"text-sm text-gray-500",children:H(e.createdAt)}),"cancelled"===e.status&&e.cancelledAt&&Y.jsxs("p",{className:"text-sm text-gray-400",children:["Cancelado: ",H(e.cancelledAt)]})]}),Y.jsxs("div",{className:"flex items-center space-x-4",children:[Y.jsxs("div",{className:"text-right",children:[Y.jsx("p",{className:"text-lg font-semibold "+("cancelled"===e.status?"text-gray-500 line-through":"text-gray-900"),children:q(e.amount)}),Y.jsxs("p",{className:"text-sm text-gray-500",children:[q(e.amount/g.participants.length)," por persona"]})]}),Y.jsxs("div",{className:"flex items-center space-x-2",children:["cancelled"!==e.status&&Y.jsx("button",{onClick:()=>(async e=>{if(!s)return;window.confirm("¬øEst√°s seguro de que quieres cancelar este gasto? Se marcar√° como cancelado pero se mantendr√° en el historial.")&&await m(s,e)&&M()})(e.id),className:"p-2 text-orange-500 hover:bg-orange-50 rounded-lg transition-colors",title:"Cancelar gasto",children:Y.jsx($,{size:16})}),Y.jsx("button",{onClick:()=>(async e=>{if(!s)return;window.confirm("¬øEst√°s seguro de que quieres eliminar este gasto? Esta acci√≥n no se puede deshacer.")&&await d(s,e)&&M()})(e.id),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:"Eliminar gasto",children:Y.jsx(_,{size:16})})]})]})]},a))})]}),Y.jsx(We,{groupId:g.id}),j&&Y.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:Y.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[Y.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Agregar Gasto"}),Y.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!s)return;const a={...L,amount:parseFloat(L.amount),paidBy:L.paidBy||r||""};await o(s,a)&&(U({description:"",amount:"",paidBy:r||""}),N(!1),M())},className:"space-y-4",children:[Y.jsxs("div",{children:[Y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripci√≥n *"}),Y.jsx("input",{type:"text",value:L.description,onChange:e=>U({...L,description:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-base-500 focus:border-base-500",placeholder:"Ej: Cena en restaurante",required:!0})]}),Y.jsxs("div",{children:[Y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Monto (USD) *"}),Y.jsx("input",{type:"number",step:"0.01",value:L.amount,onChange:e=>U({...L,amount:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-base-500 focus:border-base-500",placeholder:"0.00",required:!0})]}),Y.jsxs("div",{children:[Y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pagado por"}),Y.jsx("select",{value:L.paidBy,onChange:e=>U({...L,paidBy:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-base-500 focus:border-base-500",children:g.participants.map((e,s)=>Y.jsx("option",{value:e,children:e===r?"T√∫":`${e.slice(0,6)}...${e.slice(-4)}`},s))})]}),Y.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[Y.jsx("button",{type:"button",onClick:()=>N(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancelar"}),Y.jsx("button",{type:"submit",disabled:h,className:"px-4 py-2 bg-base-500 text-white rounded-lg hover:bg-base-600 transition-colors disabled:opacity-50",children:h?"Agregando...":"Agregar Gasto"})]})]})]})}),w&&Y.jsx(Me,{groupId:g.id,address:P,currentName:x(g.id,P),onClose:()=>{C(!1),I(""),M()}}),S&&F&&Y.jsx(qe,{groupId:g.id,from:F.from,to:F.to,amount:F.amount,onClose:()=>{k(!1),A(null),M()}})]}):Y.jsxs("div",{className:"text-center py-12",children:[Y.jsx("div",{className:"w-16 h-16 bg-base-100 rounded-full flex items-center justify-center mx-auto mb-4",children:Y.jsx(y,{className:"w-8 h-8 text-base-500"})}),Y.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Grupo no encontrado"}),Y.jsx("p",{className:"text-gray-600 mb-6",children:"El grupo que buscas no existe o no tienes acceso a √©l."}),Y.jsx("button",{onClick:()=>a("/"),className:"px-4 py-2 bg-base-500 text-white rounded-lg hover:bg-base-600 transition-colors",children:"Volver al Dashboard"})]}):Y.jsx("div",{className:"text-center py-12",children:Y.jsxs("div",{className:"max-w-md mx-auto",children:[Y.jsx("div",{className:"w-16 h-16 bg-base-100 rounded-full flex items-center justify-center mx-auto mb-4",children:Y.jsx(y,{className:"w-8 h-8 text-base-500"})}),Y.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Conecta tu Wallet"}),Y.jsx("p",{className:"text-gray-600",children:"Necesitas conectar tu wallet para ver los detalles del grupo."})]})})};function Xe(){return Y.jsx(ze,{children:Y.jsxs(i,{children:[Y.jsx(c,{path:"/",element:Y.jsx(Ge,{})}),Y.jsx(c,{path:"/create-group",element:Y.jsx(Ue,{})}),Y.jsx(c,{path:"/group/:id",element:Y.jsx(Qe,{})}),Y.jsx(c,{path:"*",element:Y.jsx("div",{children:"404 - Page Not Found"})})]})})}Q.createRoot(document.getElementById("root")).render(Y.jsx(a.StrictMode,{children:Y.jsx(o,{children:Y.jsx(Se,{children:Y.jsxs(Ie,{children:[Y.jsx(Xe,{}),Y.jsx(U,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#1f2937",color:"#f9fafb",border:"1px solid #374151",borderRadius:"12px",fontSize:"14px",fontWeight:"500"},success:{iconTheme:{primary:"#10b981",secondary:"#f9fafb"}},error:{iconTheme:{primary:"#ef4444",secondary:"#f9fafb"}},loading:{iconTheme:{primary:"#0052FF",secondary:"#f9fafb"}}}})]})})})}));
